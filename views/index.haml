.container
	.content
		.wrapper
			.proper-content				
				%form{ :action => "#", :id => "grok-form" }
					%input{ :type => "text", :class => "span12", :placeholder => "Input", :id => "input" }
					%input{ :type => "text", :class => "span12", :placeholder => "Pattern", :id => "pattern" }
					%lable{ :class => "checkbox inline",}
						%input{ :id => "keep_empty_captures", :type => "checkbox", :value= => "" }
							Keep Empty Captures
					%label{ :class => "checkbox inline" }
						%input{ :id => "named_captures_only", :type => "checkbox", :value => "" }
							Named Captures Only
					%label{ :class => "checkbox inline" }
						%input{ :id => "singles", :type => "checkbox", :value => "" }
							Singles
				%div{ :class => "well" }
					%pre{ :id => "grok" }
			.push
		.footer-wrapper
			%footer
				%div=haml :footer

%script{ :type => "text/javascript", :src =>"https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"}
%script{ :type => "text/javascript", :src => "http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js" }
%script{ :type => "text/javascript", :src => "suggest.js" }
:javascript
	var match = function() {
		var input = $('#input').val();
		var pattern = $('#pattern').val();
		var named_captures_only = $('#named_captures_only').is(':checked');
		var keep_empty_captures = $('#keep_empty_captures').is(':checked');
		var singles = $('#singles').is(':checked');
		$.post('/grok',
			{
				"input":input,
				"pattern":pattern,
				"named_captures_only":named_captures_only,
				"keep_empty_captures":keep_empty_captures,
				"singles":singles
			}, function(data){
			$('#grok').html(data);
		});
	};
	var oldPat = $("#pattern").val();
	var oldIn = $("#input").val();
	setInterval(function (){
		pat = $("#pattern").val();
		inp = $("#input").val();
		if(inp == oldIn && pat == oldPat){
			return;
		} else {
			oldPat = pat;
			oldIn = inp;
			match();
		}
	}, 1000);
	$("#named_captures_only").click(function(){
		 match();
	})
	$("#keep_empty_captures").click(function(){
			match();
	})
	$("#singles").click(function(){
		match();
	})
	$("#grok-form").submit(match);
	$(document).ready(function () {
		var tags = #{@tags};
		$('#pattern').asuggest(tags, {
			'delimiters': '}',
			'stopSuggestionKeys': [$.asuggestKeys.RETURN,39] // Last is right arrow
		}); 
	});
